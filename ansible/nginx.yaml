---
- name: Install and start Nginx
  hosts: localhost
  become: yes
  connection: local

  tasks:

    - name: Enable nginx extras repo
      command: amazon-linux-extras enable nginx1
      args:
        creates: /etc/yum.repos.d/amzn2extra-nginx1.repo

    - name: Install nginx
      yum:
        name: nginx
        state: present

    - name: Start nginx
      service:
        name: nginx
        state: started
        enabled: yes

    - name: Create index file
      copy:
        dest: /usr/share/nginx/html/index.html
        content: |
          <h1>DevOps Capstone</h1>
          <h2>Configured by Ansible Pull</h2>
